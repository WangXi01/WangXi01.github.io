<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="JS," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="PS:在51cto上面看到的，搬过来，这是原来的地址：从零开始编写自己的JavaScript框架（一）
1.模块的定义和加载1.1模块的定义一个框架想要能支撑较大的应用，首先要考虑怎么做模块化。有了内核和模块加载系统，外围的模块就可以一个一个增加。不同的JavaScript框架，实现模块化方式各有不同，我们来选择一种比较优雅的方式作个讲解。
先问个问题：我们做模块系统的目的是什么？如果觉得这个问题">
<meta property="og:type" content="article">
<meta property="og:title" content="javascript框架编写">
<meta property="og:url" content="https://wangxi01.github.io/2016/08/12/javascript框架编写/index.html">
<meta property="og:site_name" content="来亦何哀，去亦何苦">
<meta property="og:description" content="PS:在51cto上面看到的，搬过来，这是原来的地址：从零开始编写自己的JavaScript框架（一）
1.模块的定义和加载1.1模块的定义一个框架想要能支撑较大的应用，首先要考虑怎么做模块化。有了内核和模块加载系统，外围的模块就可以一个一个增加。不同的JavaScript框架，实现模块化方式各有不同，我们来选择一种比较优雅的方式作个讲解。
先问个问题：我们做模块系统的目的是什么？如果觉得这个问题">
<meta property="og:updated_time" content="2016-08-12T08:53:23.329Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="javascript框架编写">
<meta name="twitter:description" content="PS:在51cto上面看到的，搬过来，这是原来的地址：从零开始编写自己的JavaScript框架（一）
1.模块的定义和加载1.1模块的定义一个框架想要能支撑较大的应用，首先要考虑怎么做模块化。有了内核和模块加载系统，外围的模块就可以一个一个增加。不同的JavaScript框架，实现模块化方式各有不同，我们来选择一种比较优雅的方式作个讲解。
先问个问题：我们做模块系统的目的是什么？如果觉得这个问题">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> javascript框架编写 | 来亦何哀，去亦何苦 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">来亦何哀，去亦何苦</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                javascript框架编写
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-12T16:36:04+08:00" content="2016-08-12">
              2016-08-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JS/" itemprop="url" rel="index">
                    <span itemprop="name">JS</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/12/javascript框架编写/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/12/javascript框架编写/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>PS:在51cto上面看到的，搬过来，这是原来的地址：<strong><a href="http://developer.51cto.com/art/201307/402594_all.htm" target="_blank" rel="external">从零开始编写自己的JavaScript框架（一）</a></strong></p>
<h2 id="1-模块的定义和加载"><a href="#1-模块的定义和加载" class="headerlink" title="1.模块的定义和加载"></a>1.模块的定义和加载</h2><h3 id="1-1模块的定义"><a href="#1-1模块的定义" class="headerlink" title="1.1模块的定义"></a>1.1模块的定义</h3><p>一个框架想要能支撑较大的应用，首先要考虑怎么做模块化。有了内核和模块加载系统，外围的模块就可以一个一个增加。不同的JavaScript框架，实现模块化方式各有不同，我们来选择一种比较优雅的方式作个讲解。</p>
<p>先问个问题：我们做模块系统的目的是什么？如果觉得这个问题难以回答，可以从反面来考虑：假如不做模块系统，有什么样的坏处？</p>
<p>我们经历过比较粗放、混乱的前端开发阶段，页面里充满了全局变量，全局函数。那时候要复用js文件，就是把某些js函数放到一个文件里，然后让多个页面都来引用。</p>
<a id="more"></a>
<p>考虑到一个页面可以引用多个这样的js，这些js互相又不知道别人里面写了什么，很容易造成命名的冲突，而产生这种冲突的时候，又没有哪里能够提示出来。所以我们要有一种办法，把作用域比较好地隔开。</p>
<p>JavaScript这种语言比较奇怪，奇怪在哪里呢，它的现有版本里没package跟class，要是有，我们也没必要来考虑什么自己做模块化了。那它是要用什么东西来隔绝作用域呢？</p>
<p>在很多传统高级语言里，变量作用域的边界是大括号，在{}里面定义的变量，作用域不会传到外面去，但我们的JavaScript大人不是这样的，他的边界是function。所以我们这段代码，i仍然能打出值：</p>
<pre><code>for (var i=0; i&lt;5; i++) { 
    //do something  
}    
alert(i); 
</code></pre><p>那么，我们只能选用function做变量的容器，把每个模块封装到一个function里。现在问题又来了，这个function本身的作用域是全局的，怎么办？我们想不到办法，拔剑四顾心茫然。</p>
<p>我们有没有什么可参照的东西呢？这时候，脑海中一群语言飘过： C语言飘过：“我不是面向对象语言哦~不需要像你这么组织哦~”，“死开！” Java飘过：“我是纯面向对象语言哦，连main都要在类中哦，编译的时候通过装箱清单指定入口哦~”，“死开！” C++飘过：“我也是纯面向对象语言哦”，等等，C++是纯面向对象的语言吗？你的main是什么？？？main是特例，不在任何类中！</p>
<p>啊，我们发现了什么，既然无法避免全局的作用域，那与其让100个function都全局，不如只让一个来全局，其他的都由它管理。</p>
<p>本来我们打算自己当上帝的，现在只好改行先当个工商局长。你想开店吗？先来注册，不然封杀你！于是良民们纷纷来注册。店名叫什么，从哪进货，卖什么的，一一登记在案，为了方便下面的讨论，我们连进货的过程都让工商局管理起来。</p>
<p>店名，指的就是这里的模块名，从哪里进货，代表它依赖什么其他模块，卖什么，表示它对外提供一些什么特性。</p>
<p>好了，考虑到我们的这个注册管理机构是个全局作用域，我们还得把它挂在window上作为属性，然后再用一个function隔离出来，要不然，别人也定义一个同名的，就把我们覆盖掉了。</p>
<pre><code>(function() { 
    window.thin = {    
        define: function(name, dependencies, factory) {        
            //register a module              
        }        
    };       
</code></pre><p>  })();<br>  在这个module方法内部，应当怎么去实现呢？我们的module应当有一个地方存储，但存储是要在工商局内部的，不是随便什么人都可以看到的，所以，这个存储结构也放在工商局同样的作用域里。</p>
<p>用什么结构去存储呢？工商局备案的时候，店名不能跟已有的重复，所以我们发现这是用hash的很好场景，考虑到JavaScript语言层面没有hash，我们弄个Object来存。</p>
<pre><code>(function() { 
    var moduleMap = {}; 
    window.thin = { 
        define: function(name, dependencies, factory) { 
            if (!moduleMap[name]) { 
                var module = { 
                    name: name, 
                    dependencies: dependencies, 
                    factory: factory 
                }; 
                moduleMap[name] = module; 
            } 
            return moduleMap[name]; 
        } 
    }; 
})();                         
</code></pre><p>现在，模块的存储结构就搞好了。</p>
<h3 id="1-2-模块的使用"><a href="#1-2-模块的使用" class="headerlink" title="1.2 模块的使用"></a>1.2 模块的使用</h3><p>存的部分搞好了，我们来看看怎么取。现在来了一个商家，卖木器的，他需要从一个卖钉子的那边进货，卖钉子的已经来注册过了，现在要让这个木器厂能买 到钉子。现在的问题是，两个商家处于不同的作用域，也就是说，它们互相不可见，那通过什么方式，我们才能让他们产生调用关系呢？</p>
<p>个人解决不了的问题还是得靠政府，有困难要坚决克服，没有困难就制造困难来克服。现在困难有了，该克服了。商家说，我能不能给你我的进货名单，你帮我查一下它们在哪家店，然后告诉我？这么简单的要求当然一口答应下来，但是采用什么方式传递给你呢？这可犯难了。</p>
<p>我们参考AngularJS框架，写了一个类似的代码：</p>
<pre><code>thin.define(&quot;A&quot;, [], function() { 
    //module A 
}); 

thin.define(&quot;B&quot;, [&quot;A&quot;], function(A) { 
    //module B 
    var a = new A(); 
}); 
</code></pre><p>看这段代码特别在哪里呢？模块A的定义，毫无特别之处，主要看模块B。它在依赖关系里写了一个字符串的A，然后在工厂方法的形参写了一个真真切切的A类 型。嗯？这个有些奇怪啊，你的A类型要怎么传递过来呢？其实是很简单的，因为我们声明了依赖项的数组，所以可以从依赖项，挨个得到对应的工厂方法，然后创 建实例，传进来。</p>
<pre><code>use: function(name) { 
    var module = moduleMap[name]; 

    if (!module.entity) { 
        var args = []; 
        for (var i=0; i&lt;module.dependencies.length; i++) { 
            if (moduleMap[module.dependencies[i]].entity) { 
                args.push(moduleMap[module.dependencies[i]].entity); 
            } 
            else { 
                args.push(this.use(module.dependencies[i])); 
            } 
        } 

        module.entity = module.factory.apply(noop, args); 
    } 

    return module.entity; 
} 
</code></pre><p>我们可以看到，这里面递归获取了依赖项，然后当作参数，用这个模块的工厂方法来实例化了一下。这里我们多做了一个判断，如果模块工厂已经执行过，就缓存在entity属性上，不需要每次都创建。以此类推，假如一个模块有多个依赖项，也可以用类似的方式写，毫无压力：</p>
<pre><code>thin.define(&quot;D&quot;, [&quot;A&quot;, &quot;B&quot;, &quot;C&quot;], function(A, B, C) { 
    //module D 
    var a = new A(); 
    var b = new B(); 
    var c = new C(); 
}); 
</code></pre><p>注意了，D模块的工厂，实参的名称未必就要是跟依赖项一致，比如，以后我们代码较多，可以给依赖项和模块名称加命名空间，可能变成这样：</p>
<pre><code>thin.define(&quot;foo.D&quot;, [&quot;foo.A&quot;, &quot;foo.B&quot;, &quot;foo.C&quot;], function(A, B, C) { 
    //module D 
    var a = new A(); 
    var b = new B(); 
    var c = new C(); 
}); 
</code></pre><p>这段代码仍然可以正常运行。我们来做另外一个测试，改变形参的顺序：</p>
<pre><code>thin.define(&quot;A&quot;, [], function() { 
    return &quot;a&quot;; 
}); 

thin.define(&quot;B&quot;, [], function() { 
    return &quot;b&quot;; 
}); 

thin.define(&quot;C&quot;, [], function() { 
    return &quot;c&quot;; 
}); 

thin.define(&quot;D&quot;, [&quot;A&quot;, &quot;B&quot;, &quot;C&quot;], function(B, A, C) { 
    return B + A + C; 
}); 

var D = thin.use(&quot;D&quot;); 
alert(D); 
</code></pre><p>试试看，我们的D打出什么结果呢？结果是”abc”，所以说，模块工厂的实参只跟依赖项的定义有关，跟形参的顺序无关。我们看到，在AngularJS里面，并非如此，实参的顺序是跟形参一致的，这是怎么做到的呢？</p>
<p>我们先离开代码，思考这么一个问题：如何得知函数的形参名数组？对，我们是可以用func.length得到形参个数，但无法得到每个形参的变量名，那怎么办呢？</p>
<p>AngularJS使用了一种比较极端的办法，分析了函数的字面量。众所周知，在JavaScript中，任何对象都隐含了toString方法， 对于一个函数来说，它的toString就是自己的实现代码，包含函数签名和注释。下面我贴一下AngularJS里面的这部分代码：</p>
<pre><code>var FN_ARGS = /^function\s*[^\(]*\(\s*([^\)]*)\)/m; 
var FN_ARG_SPLIT = /,/; 
var FN_ARG = /^\s*(_?)(\S+?)\1\s*$/; 
var STRIP_COMMENTS = /((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg; 
function annotate(fn) { 
  var $inject, 
      fnText, 
      argDecl, 
      last; 

  if (typeof fn == &apos;function&apos;) { 
    if (!($inject = fn.$inject)) { 
      $inject = []; 
      fnText = fn.toString().replace(STRIP_COMMENTS, &apos;&apos;); 
      argDecl = fnText.match(FN_ARGS); 
      forEach(argDecl[1].split(FN_ARG_SPLIT), function(arg){ 
        arg.replace(FN_ARG, function(all, underscore, name){ 
          $inject.push(name); 
        }); 
      }); 
      fn.$inject = $inject; 
    } 
  } else if (isArray(fn)) { 
    last = fn.length - 1; 
    assertArgFn(fn[last], &apos;fn&apos;); 
    $inject = fn.slice(0, last); 
  } else { 
    assertArgFn(fn, &apos;fn&apos;, true); 
  } 
  return $inject; 
} 
</code></pre><p>可以看到，这个代码也不长，重点是类型为function的那段，首先去除了注释，然后获取了形参列表字符串，这段正则能获取到两个结果，第一个是 全函数的实现，第二个才是真正的形参列表，取第二个出来split，就得到了形参的字符串列表了，然后按照这个顺序再去加载依赖模块，就可以让形参列表不 对应于依赖项数组了。</p>
<p>AngularJS的这段代码很强大，但是要损耗一些性能，考虑到我们的框架首要原则是简单，甚至可以为此牺牲一些灵活性，我们不做这么复杂的事情了。</p>
<h3 id="1-3-模块的加载"><a href="#1-3-模块的加载" class="headerlink" title="1.3 模块的加载"></a>1.3 模块的加载</h3><p>到目前为止，我们可以把多个模块都定义在一个文件中，然后手动引入这个js文件，但是如果一个页面要引用很多个模块，引入工作就变得比较麻烦，比如 说，单页应用程序（SPA）一般比较复杂，往往包含数以万计行数的js代码，这些代码至少分布在几十个甚至成百上千的模块中，如果我们也在主界面就加载它 们，载入时间会非常难以接受。但我们可以这样看：主界面加载的时候，并不是用到了所有这些功能，能否先加载那些必须的，而把剩下的放在需要用的时候再去加 载？</p>
<p>所以我们可以考虑万能的AJAX，从服务端获取一个js的内容，然后……，怎么办，你当然说不能eval了，因为据说eval很evil啦，但是它 evil在哪里呢？主要是破坏全局作用域啦，怎么怎么，但是如果这些文件里面都是按照我们规定的模块格式写，好像也没有什么在全局作用域的……，好吧。</p>
<p>算了，我们还是用最简单的方式了，就是动态创建script标签，然后设置src，添加到document.head里，然后监听它们的完成事件， 做后续操作。真的很简单，因为我们的框架不需要考虑那么多种情况，不需要AMD，不需要require那么麻烦，用这框架的人必须按照这里的原则写。</p>
<p>所以，说真的我们这里没那么复杂啦，要是你们想看更详细原理的不如去看这个，解释得比我好哎：<a href="http://coolshell.cn/articles/9749.html#jtss-tsina" target="_blank" rel="external">http://coolshell.cn/articles/9749.html#jtss-tsina</a></p>
<p>我也偷懒了，只是贴一下代码，顺便解释一下，界面把所依赖的js文件路径放在数组里，然后挨个创建script标签，src设置为路径，添加到 head中，监听它们的完成事件。在这个完成时间里，我们要做这么一些事情：在fileMap里记录当前js文件的路径，防止以后重复加载，检查列表中所 有文件，看看是否全部加载完了，如果全加载好了，就执行回调。</p>
<pre><code>require: function (pathArr, callback) { 
    for (var i = 0; i &lt; pathArr.length; i++) { 
        var path = pathArr[i]; 

        if (!fileMap[path]) { 
            var head = document.getElementsByTagName(&apos;head&apos;)[0]; 
            var node = document.createElement(&apos;script&apos;); 
            node.type = &apos;text/javascript&apos;; 
            node.async = &apos;true&apos;; 
            node.src = path + &apos;.js&apos;; 
            node.onload = function () { 
                fileMap[path] = true; 
                head.removeChild(node); 
                checkAllFiles(); 
            }; 
            head.appendChild(node); 
        } 
    } 

    function checkAllFiles() { 
        var allLoaded = true; 
        for (var i = 0; i &lt; pathArr.length; i++) { 
            if (!fileMap[pathArr[i]]) { 
                allLoaded = false; 
                break; 
            } 
        } 

        if (allLoaded) { 
            callback(); 
        } 
    } 
} 
</code></pre><h3 id="1-4-小结"><a href="#1-4-小结" class="headerlink" title="1.4 小结"></a>1.4 小结</h3><p>到此为止，我们的简易框架的模块定义系统就完成了。完整的代码如下：</p>
<pre><code>(function () { 
    var moduleMap = {}; 
    var fileMap = {}; 

    var noop = function () { 
    }; 

    var thin = { 
        define: function(name, dependencies, factory) { 
            if (!moduleMap[name]) { 
                var module = { 
                    name: name, 
                    dependencies: dependencies, 
                    factory: factory 
                }; 

                moduleMap[name] = module; 
            } 

            return moduleMap[name]; 
        }, 

        use: function(name) { 
            var module = moduleMap[name]; 

            if (!module.entity) { 
                var args = []; 
                for (var i=0; i&lt;module.dependencies.length; i++) { 
                    if (moduleMap[module.dependencies[i]].entity) { 
                        args.push(moduleMap[module.dependencies[i]].entity); 
                    } 
                    else { 
                        args.push(this.use(module.dependencies[i])); 
                    } 
                } 

                module.entity = module.factory.apply(noop, args); 
            } 

            return module.entity; 
        }, 

        require: function (pathArr, callback) { 
            for (var i = 0; i &lt; pathArr.length; i++) { 
                var path = pathArr[i]; 

                if (!fileMap[path]) { 
                    var head = document.getElementsByTagName(&apos;head&apos;)[0]; 
                    var node = document.createElement(&apos;script&apos;); 
                    node.type = &apos;text/javascript&apos;; 
                    node.async = &apos;true&apos;; 
                    node.src = path + &apos;.js&apos;; 
                    node.onload = function () { 
                        fileMap[path] = true; 
                        head.removeChild(node); 
                        checkAllFiles(); 
                    }; 
                    head.appendChild(node); 
                } 
            } 

            function checkAllFiles() { 
                var allLoaded = true; 
                for (var i = 0; i &lt; pathArr.length; i++) { 
                    if (!fileMap[pathArr[i]]) { 
                        allLoaded = false; 
                        break; 
                    } 
                } 

                if (allLoaded) { 
                    callback(); 
                } 
            } 
        } 
    }; 

    window.thin = thin; 
})(); 
</code></pre><p>测试代码如下：</p>
<pre><code>thin.define(&quot;constant.PI&quot;, [], function() { 
    return 3.14159; 
}); 

thin.define(&quot;shape.Circle&quot;, [&quot;constant.PI&quot;], function(pi) { 
    var Circle = function(r) { 
        this.r = r; 
    }; 

    Circle.prototype = { 
        area : function() { 
            return pi * this.r * this.r; 
        } 
    } 

    return Circle; 
}); 

thin.define(&quot;shape.Rectangle&quot;, [], function() { 
    var Rectangle = function(l, w) { 
        this.l = l; 
        this.w = w; 
    }; 

    Rectangle.prototype = { 
        area: function() { 
            return this.l * this.w; 
        } 
    }; 

    return Rectangle; 
}); 

thin.define(&quot;ShapeTypes&quot;, [&quot;shape.Circle&quot;, &quot;shape.Rectangle&quot;], function(Circle, Rectangle) { 
    return { 
        CIRCLE: Circle, 
        RECTANGLE: Rectangle 
    }; 
}); 

thin.define(&quot;ShapeFactory&quot;, [&quot;ShapeTypes&quot;], function(ShapeTypes) { 
    return { 
        getShape: function(type) { 
            var shape; 

            switch (type) { 
                case &quot;CIRCLE&quot;: { 
                    shape = new ShapeTypes[type](arguments[1]); 
                    break; 
                } 
                case &quot;RECTANGLE&quot;:  { 
                    shape = new ShapeTypes[type](arguments[1], arguments[2]); 
                    break; 
                } 
            } 

            return shape; 
        } 
    }; 
}); 

var ShapeFactory = thin.use(&quot;ShapeFactory&quot;); 
alert(ShapeFactory.getShape(&quot;CIRCLE&quot;, 5).area()); 
alert(ShapeFactory.getShape(&quot;RECTANGLE&quot;, 3, 4).area()); 
</code></pre><p>在这个例子里定义了四个模块，每个模块只需要定义自己所直接依赖的模块，其他的可以不必定义。也可以来这里看测试链接：<a href="http://xufei.github.io/thin/demo/demo.0.1.html" target="_blank" rel="external">http://xufei.github.io/thin/demo/demo.0.1.html</a>.</p>

      
    </div>

    <div>
      
        
      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/JS/" rel="tag">#JS</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/08/11/表单隐藏域/" rel="next" title="表单隐藏域">
                <i class="fa fa-chevron-left"></i> 表单隐藏域
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/08/16/querySelector/" rel="prev" title="querySelector和querySelectorAll的一个小例子">
                querySelector和querySelectorAll的一个小例子 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2016/08/12/javascript框架编写/"
           data-title="javascript框架编写" data-url="https://wangxi01.github.io/2016/08/12/javascript框架编写/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/IMG_20160811_151751.jpg"
               alt="WangXi" />
          <p class="site-author-name" itemprop="name">WangXi</p>
          <p class="site-description motion-element" itemprop="description">“美国的华莱士，比你们不知要高到哪里去了，我跟他谈笑风生。”——长者</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">6</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-模块的定义和加载"><span class="nav-number">1.</span> <span class="nav-text">1.模块的定义和加载</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1模块的定义"><span class="nav-number">1.1.</span> <span class="nav-text">1.1模块的定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-模块的使用"><span class="nav-number">1.2.</span> <span class="nav-text">1.2 模块的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-模块的加载"><span class="nav-number">1.3.</span> <span class="nav-text">1.3 模块的加载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-小结"><span class="nav-number">1.4.</span> <span class="nav-text">1.4 小结</span></a></li></ol></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">WangXi</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"WangXi01"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  





  
  
  

  

  

</body>
</html>
